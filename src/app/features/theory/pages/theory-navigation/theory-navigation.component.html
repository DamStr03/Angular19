<theory-header chapterName="Navigation" />
<section class="card-body">
	<p>
		Jusque maintenant, pour se d√©placer de page en page, nous utilisons <code>routerLink</code> dans une balise <code>&lt;a&gt;</code>.
	</p>
	<article class="card">
		<div class="card-header">
			<h2>Redirection depuis le code</h2>
		</div>
		<div class="card-body">
			<i>Mais comment puis-je rediriger l'utilisateur vers une autre page sans lui demander de cliquer?</i>
			<p>Nous pouvons utiliser le service <code>Router</code> pour rediriger l'utilisateur vers une autre page.</p>
			<p>Pour cela, nous devons d'abord l'injecter dans notre composant.</p>
			<p>Ensuite, nous pouvons appeler la m√©thode <code>navigate()</code> du service <code>Router</code>.</p>
			<textarea highlight-js [options]="{}" [lang]="'typescript'">
			this._router.navigate(['/', 'path']);
			</textarea
			>
			<p>Cela redirigera l'utilisateur vers la page sp√©cifi√©e dans le tableau de cha√Ænes de caract√®res.</p>
			<i>üîé l'utilisateur sera rediriger vers l'url : <code>http://localhost:4200/path</code></i>
		</div>
	</article>

	<article class="card">
		<div class="card-header">
			<h2>Navigation avec param√®tre</h2>
		</div>
		<div class="card-body">
			<p>La navigation avec param√®tre permet de passer des informations "simple" √† la page cible.</p>
			<h3>Routing</h3>
			<p>
				Par exemple: <code>http://localhost:4200/book/14</code>, le "14" est un param√®tre simple qui signifie que l'on souhaite
				obtenir les d√©tails du livre avec l'id 14. <br />
				pour ne pas devoir cr√©er une route: <code>/book/14</code>, <code>/book/15</code>, <code>/book/16</code>... si on a 100
				livres, on peut cr√©er une route avec une navigation param√©tr√©e.
			</p>
			<p>Dans le fichier de routing, on notera par exemple:</p>
			<textarea highlight-js [options]="{}" [lang]="'typescript'">
{
  path: "book/:id",
  loadComponent: () => import("./features/book/pages/book-detail/book-detail.component").then(c => c.BookDetailComponent),
},
			</textarea
			>
			<p>Le fait de mettre <code>:</code> dans la route indique que le morceau qui suit est une param√®tre qui sera variable.</p>
			<h3>Composant</h3>
			<p>Pour r√©cup√©rer le param√®tre, nous utilisons le serivce <code>ActivatedRoute</code>:</p>
			<textarea highlight-js [options]="{}" [lang]="'typescript'">
import {Component, inject} from "@angular/core";
import {ActivatedRoute} from "@angular/router";

@Component({
  selector: "app-book-detail",
  templateUrl: "./book-detail.component.html",
  styleUrl: "./book-detail.component.scss",
})
export class BookDetailComponent {
  private readonly _activatedRoute: ActivatedRoute = inject(ActivatedRoute);

  valueFromRoute: string | null = null;

  ngOnInit() {
    this._activatedRoute.params.subscribe({
      next: params => {
        this.valueFromRoute = params["id"];
      },
    });
  }
}
  			</textarea
			>
		</div>
	</article>

	<article class="card">
		<div class="card-header">
			<h2>Param√®tre dans l'url</h2>
		</div>
		<div class="card-body">
			<p>
				Il est aussi possible de passer des param√®tres dans l'url, par exemple:
				<code>http://localhost:4200/demo/14?author=J.%20K.%20Rowling&hello=world</code>.
			</p>
			<p>Ce qui permet de stocker un objet <code>&#123;"author":"J. K. Rowling","hello":"world"&#125;</code></p>
			<h3>Pour stocker des informations dans l'URL</h3>
			<p>Lors de la redirection, nous rajoutons un objet apr√®s le tableau du <code>path</code>:</p>
			<textarea highlight-js [options]="{}" [lang]="'typescript'">
this._router.navigate(["/", "demo", "14"],
{ // options suppl√©mentaires pour la redirection
  queryParams: {author: "J. K. Rowling", hello: "world"}, // parametre dans l'URL
});
			</textarea
			>
			<h3>R√©cup√©rer les informations</h3>
			<textarea highlight-js [options]="{}" [lang]="'typescript'">
import {Component, inject} from "@angular/core";
import {ActivatedRoute} from "@angular/router";

@Component({
  selector: "app-book-detail",
  templateUrl: "./book-detail.component.html",
  styleUrl: "./book-detail.component.scss",
})
export class BookDetailComponent {
  private readonly _activatedRoute: ActivatedRoute = inject(ActivatedRoute);

  valueFromRoute: string | null = null;

  ngOnInit() {
    this._activatedRoute.queryParams.subscribe({
      next: params => {
        const str = JSON.stringify(params);
        if (str.length > 2) {
          // plus grand que 2 car "{}" est le minimum
          this.valueFromRoute = JSON.stringify(params);
        }
      },
    });
  }
}
			</textarea
			>
		</div>
	</article>

	<article class="card">
		<div class="card-header">
			<h2>√âvenements</h2>
		</div>
		<div class="card-body">
			<p>Lorsqu'on navigue dans l'application et qu'on passe d'un composant √† l'autre, nous traversons une s√©rie d'√©venements:</p>
			<ul>
				<li><code>NavigationStart</code>: l'utilisateur a cliqu√© sur un lien et la navigation commence.</li>
				<li><code>RoutesRecognized</code>: les routes ont √©t√© reconnues et le composant correspondant a √©t√© trouv√©.</li>
				<li><code>GuardsCheckStart</code>: les gardes de route commencent √† √™tre v√©rifi√©s.</li>
				<li><code>ChildActivationStart</code>: le composant enfant commence √† √™tre activ√©.</li>
				<li><code>ActivationStart</code>: le composant commence √† √™tre activ√©.</li>
				<li><code>GuardsCheckEnd</code>: les gardes de route ont √©t√© v√©rifi√©s avec succ√®s.</li>
				<li><code>ResolveStart</code>: la r√©solution des donn√©es commence.</li>
				<li><code>ResolveEnd</code>: la r√©solution des donn√©es est termin√©e.</li>
				<li><code>ActivationEnd</code>: le composant est activ√© avec succ√®s.</li>
				<li><code>ChildActivationEnd</code>: le composant enfant est activ√© avec succ√®s.</li>
				<li><code>NavigationEnd</code>: la navigation est termin√©e avec succ√®s.</li>
			</ul>
			<p>Nous pouvons √©couter ces √©venements en utilisant le service <code>Router</code>:</p>
			<textarea highlight-js [options]="{}" [lang]="'typescript'">
this._router.events.subscribe({
  next: event => {
    console.log(event);
  },
});
			</textarea
			>
		</div>
	</article>
</section>
