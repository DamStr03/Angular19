<theory-header chapterName="Service et Injection de d√©pendance" />
<section class="card">
	<article class="card">
		<div class="card-header">
			<h2>Qu'est-ce qu'un Service en Angular ?</h2>
		</div>
		<div class="card-body">
			<p>
				Un <strong>service</strong> en Angular est une classe qui contient des m√©thodes r√©utilisables que plusieurs composants
				peuvent appeler. Un service permet de <strong>centraliser la logique m√©tier</strong> (t√¢ches telles que les appels HTTP, la
				gestion de donn√©es, etc.) en dehors des composants pour respecter le principe de
				<strong>s√©paration des responsabilit√©</strong>.
			</p>
			<p>
				<strong>Par exemple</strong>: au lieu de r√©p√©ter dans plusieurs composants le m√™me appel √† une API, on peut cr√©er un
				<code>UserService</code> qui s‚Äôen charge. Chaque composant peut alors utiliser ce service pour acc√©der ou modifier les
				donn√©es utilisateurs.
			</p>
		</div>
	</article>

	<article class="card">
		<div class="card-header">
			<h2>Pourquoi utiliser des Services ?</h2>
		</div>
		<div class="card-body">
			<p>Les services offrent de nombreux avantages :</p>
			<ul>
				<li>
					<strong>R√©utilisation</strong> du code : Un service permet d'√©viter la duplication du code dans plusieurs composants.
				</li>
				<li>
					<strong>Organisation</strong> : La logique m√©tier est s√©par√©e des composants, facilitant ainsi la maintenance et la
					lisibilit√© du code.
				</li>
				<li>
					<strong>Centralisation des donn√©es</strong> : Un service peut contenir et g√©rer des informations partag√©es par plusieurs
					composants.
				</li>
			</ul>
		</div>
	</article>

	<article class="card">
		<div class="card-header">
			<h2>L'injection de d√©pendance</h2>
		</div>
		<div class="card-body">
			<p>
				L'<strong>Injection de D√©pendances</strong> est un <strong>design pattern</strong> qui consiste √† fournir une d√©pendance
				(comme un service) √† une classe plut√¥t que de la laisser cr√©er elle-m√™me cette d√©pendance.
			</p>
			<p>
				Angular a un <strong>syst√®me int√©gr√© d'injection de d√©pendances</strong>, qui permet de fournir automatiquement les services
				dont les composants ou d'autres services ont besoin.
			</p>
			<p>Par exemple, au lieu qu'un composant cr√©e une instance d'un service lui-m√™me, Angular l'injecte automatiquement :</p>
			<ul>
				<li>
					<p>Via constructeur:</p>
					<textarea highlight-js [options]="{}" [lang]="'ts'">
constructor(private _userService: UserService) {}
					</textarea
					>
				</li>
				<li>
					<p>Avec inject <i>(sans oubli√© l'import de celui-ci)</i></p>
					<textarea highlight-js [options]="{}" [lang]="'ts'">
private readonly _userService = inject(UserService);
					</textarea
					>
				</li>
			</ul>
		</div>
	</article>

	<article class="card">
		<div class="card-header"><h2>Cr√©er un service</h2></div>
		<div class="card-body">
			<h3>Cr√©ation du service</h3>
			<p>
				Pour cr√©er un service, Angular CLI offre une commande simple :<br />
				<code>ng generate service nom-du-service </code>
			</p>
			<p>
				Cela cr√©e une classe TypeScript marqu√©e par le d√©corateur <code>&#64;Injectable()</code>. Ce d√©corateur informe Angular que
				cette classe peut √™tre inject√©e dans d'autres classes.
			</p>
			<textarea highlight-js [options]="{}" [lang]="'ts'">
import {Injectable, signal} from "@angular/core";

@Injectable({
  providedIn: "root",
})
export class UserService {
  constructor() {}

  isConnected = signal(false);
}
			</textarea
			>

			<h3>Analyse</h3>
			<ul>
				<li><code>&#64;Injectable()</code> : Indique qu'Angular peut injecter ce service dans d'autres classes.</li>
				<li>
					<code>providedIn: 'root'</code> : Indique qu'Angular doit cr√©er une instance unique de ce service pour toute
					l'application. Cela signifie que le service est disponible dans toute l'application sans avoir besoin de l'ajouter
					explicitement. (comme on le verra plus tard) <br />
					<i>üîé avoir la m√™me instance pour toute l'application s'appel aussi un <code>singleton</code></i>
				</li>
				<li>
					<code>constructor()</code> : Le constructeur est vide, car il n'y a pas de logique d'initialisation n√©cessaire pour ce
					service.
				</li>
				<li>
					<code>isConnected</code> : C'est une propri√©t√© de type <code>signal</code>, qui est initialis√©e √† <code>false</code>.
					Cette propri√©t√© peut √™tre utilis√©e pour suivre l'√©tat de connexion d'un utilisateur. <br />
					<i>üîé un signal est une variable am√©lior√©e, c'est expliqu√© un peu plus bas!</i>
				</li>
			</ul>

			<h3>Injecter un service dans un composant</h3>
			<p>Comme vu pr√©c√©dement, il y a 2 mani√®res de faire de l'injection de d√©pendance:</p>
			<ul>
				<li>
					<p>Via constructeur:</p>
					<textarea highlight-js [options]="{}" [lang]="'ts'">
constructor(private _userService: UserService) {}
					</textarea
					>
					<ul>
						<li><code>private</code>, car on ne souhaite pas que puisse √™tre utiliser en dehors de la classe</li>
						<li>
							<code>_</code>, la variable commence avec un <code>_</code>, car c'est une convention de commencer les variables
							priv√©es avec un <code>_</code>
						</li>
						<li>
							<code>: UserService</code>, on pr√©cise le type de la variable, ici <code>UserService</code>
							pour indiquer quel service on souhaite injecter
						</li>
					</ul>
				</li>
				<li>
					<p>Depuis la version 14 d'Angular, avec inject <i>(sans oubli√© l'import de celui-ci)</i></p>
					<textarea highlight-js [options]="{}" [lang]="'ts'">
private readonly _userService = inject(UserService);
					</textarea
					>
					<ul>
						<li><code>private</code>, car on ne souhaite pas que puisse √™tre utiliser en dehors de la classe</li>
						<li><code>readonly</code> pour indiquer que la variable ne peut pas √™tre modifi√©e apr√®s son initialisation</li>
						<li>
							<code>_</code>, la variable commence avec un <code>_</code>, car c'est une convention de commencer les variables
							priv√©es avec un <code>_</code>
						</li>
						<li><code>inject</code> permet d'injecter le service sans passer par le constructeur</li>
						<li>
							<code>UserService</code>, on pr√©cise le type de la variable, ici <code>UserService</code>
							pour indiquer quel service on souhaite injecter
						</li>
					</ul>
				</li>
			</ul>
		</div>
	</article>
</section>
